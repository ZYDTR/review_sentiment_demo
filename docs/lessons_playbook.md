# Lessons Playbook：经验沉淀与防错规则

- 文档状态：Active
- 最后更新：2026-02-19
- 目的：将项目中的真实经验固化为可复用规则，避免重复踩坑。

## 1. 使用方式
1. 每修复一个真实问题，至少沉淀一条 Lesson。
2. 每条 Lesson 必须包含：场景、错误做法、正确做法、可执行规则。
3. 能写成检查项就写成检查项，便于执行。

## 2. Lessons 列表

### Lesson-001：先对齐边界再实现
- 场景：需求目标是“拿下职位”，重点是高质量 Demo，而非全量产品。
- 错误做法：一上来直接写代码，边做边改方向。
- 正确做法：先落地 PRD/RFC/API Facts，明确范围与验收标准，再实现。
- 规则：开始编码前必须完成最小文档闭环并得到确认。

### Lesson-002：Demo 也要有生产思维
- 场景：很多 Demo 能跑一次，但不可维护、不可重跑、不可排错。
- 错误做法：只做 happy path，不做错误处理与幂等设计。
- 正确做法：在 V1 就引入状态机、错误码、重试和幂等跳过。
- 规则：任何自动化链路必须包含 `status`、`error_reason`、`run_id`。

### Lesson-003：输出可控比模型聪明更重要
- 场景：LLM 输出格式漂移导致回写失败或统计不准确。
- 错误做法：自由文本输出，后处理靠猜。
- 正确做法：强制 JSON schema + 枚举校验 + 一次纠错重试。
- 规则：情感值必须命中枚举，摘要必须满足长度与非空约束。

### Lesson-004：过程留痕能显著提高说服力
- 场景：面试演示不仅看结果，还看工程习惯与协作质量。
- 错误做法：只展示最终效果，没有决策和问题处理证据。
- 正确做法：持续维护 `working_log` 与 `decision log`。
- 规则：每次关键改动都要记录“改了什么、为什么、如何验证”。

### Lesson-005：语言规范必须早统一
- 场景：协作成员偏好中文文档，早期出现中英混杂。
- 错误做法：文档语言不统一，增加沟通成本。
- 正确做法：根据项目要求统一中文，统一术语表述。
- 规则：若无特殊说明，所有新文档默认中文。

## 3. 发布前防错检查清单
1. 是否存在完整数据契约（输入列、输出列、状态值、错误码）？
2. 是否具备幂等与失败重试机制？
3. 是否有样本质量验证与阈值？
4. 是否有周报时间窗与时区定义？
5. 是否有可执行的演示脚本？
6. 是否有交接说明（如何改 prompt、如何重跑、如何排错）？

## 4. 新增 Lesson 模板（复制使用）
```text
Lesson 编号：
场景：
错误做法：
正确做法：
规则（可执行）：
触发条件：
验证方式：
```
